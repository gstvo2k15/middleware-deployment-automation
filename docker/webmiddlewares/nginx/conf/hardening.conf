# Prevent MIME type sniffing
add_header X-Content-Type-Options nosniff;

# Prevent clickjacking
add_header X-Frame-Options SAMEORIGIN;

# Enable strict transport security
add_header Strict-Transport-Security "max-age=31536000; includeSubDomains; preload";

# Limit connections per IP
limit_conn_zone $binary_remote_addr zone=connlimit:10m;
limit_conn connlimit 10;

# Rate limiting for login and API endpoints
limit_req_zone $binary_remote_addr zone=req_limit:10m rate=10r/s;

location /login {
    limit_req zone=req_limit burst=10 nodelay;
}

location /api/ {
    limit_req zone=req_limit burst=20 nodelay;
}
