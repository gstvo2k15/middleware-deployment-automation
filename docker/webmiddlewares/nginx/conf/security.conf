# Security headers
add_header X-Frame-Options DENY;
add_header X-Content-Type-Options nosniff;
add_header X-XSS-Protection "1; mode=block";
add_header Referrer-Policy "no-referrer";
add_header Permissions-Policy "geolocation=(), microphone=(), camera=()";

# Disable unwanted HTTP methods
if ($request_method !~ ^(GET|POST|HEAD)$) {
    return 444;
}

# Limit request body size to mitigate DoS attacks
client_max_body_size 10M;

# Block access to hidden files and directories
location ~ /\. {
    deny all;
}

# Restrict execution of scripts in uploads directory
location /uploads/ {
    location ~* \.(php|pl|py|jsp|asp|sh|cgi)$ {
        deny all;
    }
}
